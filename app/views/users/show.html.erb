<div>
    <div>
        <div>
            <div>
                <h1><%= @user.name %></h1>
                <div>
                    <%if @user.image %>
                    <div class="round">
                        <%= image_tag( @user.image ) %>
                    </div>
                    <%end %>
                </div>

                <ul>
                    <li>Name:
                        <%= @user.name %></li>
                    <li>Hourly rate:
                        <%= @user.price %></li>
                    <li>Location:
                        <%= @user.location %></li>
                    <li>Tutor for:
                        <%= @user.skills %></li>
                    <li>Learning:
                        <%= @user.learning %></li>
                    <li>Email:
                        <%= @user.email %></li>
                    <li>Bio:
                        <%= @user.bio %></li>
                </ul>

                <!-- BOOKINGS  -->

                <div>
                    <h2>Book a lesson with
                        <%= @user.name %>
                    </h2>
                    <% @all_bookings.each do |booking| %>
                    <% if booking.student_id == nil && booking.teacher_id == @user.id || booking.teacher_id == @current_user.id%>
                    <p>
                        <!-- <#%= booking.to_json %> -->
                        <%= booking.date.strftime("%e %b %y") %>
                        :
                        <%= booking.start_time.strftime("%I:%M %p") %>
                        -
                        <%= booking.end_time.strftime("%I:%M %p") %>

                        <%= form_tag "/bookings/#{booking.id}/book" do %>
                        <script src="https://checkout.stripe.com/v2/checkout.js" class="stripe-button" data-key="<%= Rails.configuration.stripe[:publishable_key] %>" data-description="<%= 'Tandem Tech' %>" data-amount="<%= booking.price %>"></script>
                        <% end %>
                    </a>
                </p>
                <% end %>
                <% end %>
            </div>

            <!-- UPCOMING BOOKINGS -->
            <div>
                <% if @current_user == @user %>
                <h2>Your upcoming lessons</h2>

                <% @all_bookings.each do |booking| %>
                <% if booking.student_id == @current_user.id || booking.teacher_id == @current_user.id %>
                <div>
                    <ul>
                        <li>
                            <li>Date: <%= booking.date.strftime("%e %b %y") %></li>
                            <li>Start time: <%= booking.start_time.strftime("%I:%M %p") %></li>
                            <li>End time: <%= booking.start_time.strftime("%I:%M %p") %></li>
                            <li>Tutor: <%= booking.teacher.name %></li>
                            <li>Student: <%= booking.student.name %></li>

                    </ul>
                </div>
                <% end %>
                <% end %>
                <% end %>
            </div>


            <!-- COMMENTS -->

            <div>
                <h2><%= @user.name %>
                    Review's</h2>
                <% @user.comments.each do |comment| %>
                <p>
                    <ul>
                        <li><%= comment.body %></li>
                        <li><%= comment.teacher.name %></li>
                    </ul>
                </p>
                <%= button_to("Delete", "/comments/#{comment.id}", method: :delete, data: {confirm: "Are you sure?"}) %>
                <% end %>
            </div>

            <div>
                <%= render 'comments/form' %>
            </div>

            <!-- Edit and delete profile -->
            <div class="container controls">
                <% if @current_user && @current_user.id == @user.id  %>
                <button type="button" name="action"><%= link_to("Edit profile", "/users/#{@user.id}/edit") %></button>

                <button type="button" name="action"><%= link_to("Delete profile", "/users/#{@user.id}", method: :delete, data: { confirm: "Are you sure?" }) %></button>
                <% end %>
            </div>

        </div>
    </div>
</div>
</div>
